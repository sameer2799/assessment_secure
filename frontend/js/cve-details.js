document.addEventListener('DOMContentLoaded', () => {
    // Extract CVE ID from URL
    const cveId = window.location.pathname.split('/').pop();
    
    // Get DOM elements
    const cveTitle = document.getElementById('cveTitle');
    const cveDetails = document.getElementById('cveDetails');
    const cvssV2Score = document.getElementById('cvssV2Score');
    const cvssV3Score = document.getElementById('cvssV3Score');

    // Fetch CVE details
    function fetchCVEDetails() {
        fetch(`http://localhost:5000/cves/${cveId}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('CVE not found');
                }
                return response.json();
            })
            .then(cve => {
                // Update page title and heading
                cveTitle.textContent = `CVE Details: ${cve.cve_id}`;
                
                // Display CVE details
                cveDetails.innerHTML = `
                    <p><strong>Description:</strong> ${cve.description}</p>
                    <p><strong>Published Date:</strong> ${new Date(cve.published_date).toLocaleDateString()}</p>
                    <p><strong>Last Modified:</strong> ${new Date(cve.last_modified_date).toLocaleDateString()}</p>
                `;

                // Update CVSS scores
                cvssV2Score.textContent = cve.cvss_v2_score || 'N/A';
                cvssV3Score.textContent = cve.cvss_v3_score || 'N/A';
            })
            .catch(error => {
                cveDetails.innerHTML = `<p>Error: ${error.message}</p>`;
            });
    }

    // Initial load of CVE details
    fetchCVEDetails();
});
